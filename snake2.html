<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Document</title>
		<style>
			*{
				padding:0;
				margin:0;
				list-style: none;
			}

			ul{
				width:400px;
				height:400px;
				border: 1px solid black;
				margin:100px auto;
				overflow: hidden;
			}

			ul li{
				float: left;
				width:18px;
				height:18px;
				border: 1px solid black;
			}

			.colGray{
				background-color: gray;
			}	
			
			.colRed{
				background-color: red;
			}

			button{
				width: 40px;
				height:30px;
			}

			input{
				width:100px;
			}
		</style>
	</head>
	<body>
		
		<div>
			<ul>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
			</ul>
		</div>
		<input type="text" value = 200>
		<button >速度-</button>
		<button>速度+</button>
		<button>开始</button>
		<script type="text/javascript">
			var liArr = document.getElementsByTagName("li");
			var timer;//定时器
			var which;//按键
			var arrSnake = [];//蛇

			var btn1 = document.getElementsByTagName("button")[0];
			var btn2 = document.getElementsByTagName("button")[1];
			var btn3 = document.getElementsByTagName("button")[2];
			var inp = document.getElementsByTagName("input")[0];
			btn2.onclick = function () {//加速
				inp.value -= 10;
			} 

			btn1.onclick = function () {//减速
				inp.value = parseInt(inp.value) + 10;
			} 

			btn3.onclick = function () {//点击开始  蛇开始走动
				gogo();
				btn3.onclick = null;
			} 




			//初始化蛇的位置
			var i = 8;//蛇的行坐标
			var j = 16;//蛇的列坐标
			var num = i * 20 + j;//加在一起是蛇头对应的li的索引位
			arrSnake = [liArr[i * 20 + j], liArr[num + 1], liArr[num + 2]];//蛇的初始长度
			for(var n = 0; n < arrSnake.length; n++) {//设置蛇身颜色
				arrSnake[n].className = "colGray";
			}


			var lock = true;
			document.onkeydown = function(e) {//键盘事件（上下左右）
				lock = false;
				var event = e || window.event;
				which = e.which;
				
			}

			//随机生成一个0~399的数
			function point() {
				var a = Math.random();
				// if(a > 0.5) {
				// 	return Math.ceil(a * 400);
				// }else{
					return Math.floor(a * 400);//向下取整
				// }
			}


			//生成食物
			function aaa() {
				num = point();
				if(liArr[num].className !== "colGray") {//如果生成的食物不在蛇身上
					liArr[num].className = "colRed";
				}else{
					aaa();//如果生成的食物在蛇身上，就再随机生成食物
				}
			}


			//蛇向左走
			function left() {
				// i;
				j--;
				dir = "left";//记录前进的方向
				if(j >= 0) {//如果蛇头没撞到边界
					a = arrSnake[arrSnake.length - 1];//首先记录蛇的尾巴位置
					for(var n = arrSnake.length - 1; n >= 0; n--) {//让蛇前进一格
						arrSnake[n] = arrSnake[n - 1];
					}
					a.className = "";//蛇 前进之前的尾巴位置变回无色
					arrSnake[0] = liArr[i * 20 + j];//新的头的位置
					arrSnake[0].className = "colGray";//给新的头设置颜色
				}else{
					clearInterval(timer);
					alert("GAME OVER");
				}
			}

			//蛇向上走
			function up() {
				// j;
				i--;
				dir = "up";
				if(i >= 0) {
					a = arrSnake[arrSnake.length - 1];
					for(var n = arrSnake.length - 1; n >= 0; n--) {
						arrSnake[n] = arrSnake[n - 1];
					}
					a.className = "";
					arrSnake[0] = liArr[i * 20 + j];
					arrSnake[0].className = "colGray";
				}else{
					clearInterval(timer);
					alert("GAME OVER");
				}
			}

			//蛇向右走
			function right() {
				// i;
				j++;
				dir = "right";
				if(j < 20) {
					a = arrSnake[arrSnake.length - 1];
					for(var n = arrSnake.length - 1; n >= 0; n--) {
						arrSnake[n] = arrSnake[n - 1];
					}
					a.className = "";
					arrSnake[0] = liArr[i * 20 + j];
					arrSnake[0].className = "colGray";
				}else{
					clearInterval(timer);
					alert("GAME OVER");
				}
			}


			//蛇向下走
			function down() {
				// j;
				i++;
				dir = "down";
				if(i < 20) {
					a = arrSnake[arrSnake.length - 1];
					for(var n = arrSnake.length - 1; n >= 0; n--) {
						arrSnake[n] = arrSnake[n - 1];
					}
					a.className = "";
					arrSnake[0] = liArr[i * 20 + j];
					arrSnake[0].className = "colGray";
				}else{
					clearInterval(timer);
					alert("GAME OVER");
				}
			}
 



			aaa();//首先生成一个食物
			var a;
			var dir;//记录前进方向
			var len;
			var stop = true;
			function gogo() {//蛇前进的函数
				timer = setInterval(function() {
					len = arrSnake.length;
					for(var m = 1; m < len; m++) {//首先判断蛇头是不是撞到自身
						if(arrSnake[0] == arrSnake[m]) {
							stop = false;
						}
					}
					if(stop) {//如果蛇头没撞到自身
						if(lock) {//开始游戏后还没有按方向键，开始向左走
							left();
						}else if(dir == "left") {//首先判断蛇的前进方向
							if(which == 39 || which == 37) {//如果按键方向和蛇的前进方向相同或者相反，则蛇继续前进
								which == undefined;
								left();
							}else if(which == 38) {//如果案件方向和蛇的前进方向不同，则蛇按按键方向前进
								up();
							}else if(which == 40) {
								down();
							}
						}else if(dir == "up") {
							if(which == 38 || which == 40) {
								which == undefined;
								up();
							}else if(which == 37) {
								left();
							}else if(which == 39) {
								right();
							}
						}else if(dir == "right") {
							if(which == 39 || which == 37) {
								which == undefined;
								right();
							}else if(which == 38) {
								up();
							}else if(which == 40) {
								down();
							}
						}else if(dir == "down") {
							if(which == 38 || which == 40) {
								which == undefined;
								down();
							}else if(which == 37) {
								left();
							}else if(which == 39) {
								right();
							}
						}
						if(arrSnake[0] == liArr[num]) {//如果蛇头吃到食物，增长蛇身
							arrSnake.push(liArr[400]);//li一共401个。索引是0~399，第400个由于在ul外面，就overflow:hidden了，每次吃到食物就把这个加到蛇的尾巴后面，增长蛇身
							aaa();//在随机生成一个食物
						}
					}else{
						clearInterval(timer);
						alert("GAME OVER");
					}
				}, inp.value)
			}
			
			// timer = setInterval(function() {
			// 	len = arrSnake.length;
			// 	for(var m = 1; m < len; m++) {
			// 		if(arrSnake[0] == arrSnake[m]) {
			// 			stop = false;
			// 		}
			// 	}
			// 	if(stop) {
			// 		if(lock) {
			// 			left();
			// 		}else if(dir == "left") {
			// 			if(which == 39 || which == 37) {
			// 				which == undefined;
			// 				left();
			// 			}else if(which == 38) {
			// 				up();
			// 			}else if(which == 40) {
			// 				down();
			// 			}
			// 		}else if(dir == "up") {
			// 			if(which == 38 || which == 40) {
			// 				which == undefined;
			// 				up();
			// 			}else if(which == 37) {
			// 				left();
			// 			}else if(which == 39) {
			// 				right();
			// 			}
			// 		}else if(dir == "right") {
			// 			if(which == 39 || which == 37) {
			// 				which == undefined;
			// 				right();
			// 			}else if(which == 38) {
			// 				up();
			// 			}else if(which == 40) {
			// 				down();
			// 			}
			// 		}else if(dir == "down") {
			// 			if(which == 38 || which == 40) {
			// 				which == undefined;
			// 				down();
			// 			}else if(which == 37) {
			// 				left();
			// 			}else if(which == 39) {
			// 				right();
			// 			}
			// 		}
			// 		if(arrSnake[0] == liArr[num]) {
			// 			arrSnake.push(liArr[399]);
			// 			aaa();
			// 		}
			// 	}else{
			// 		clearInterval(timer);
			// 		alert("GAME OVER");
			// 	}
			// }, inp.value)
		</script>
	</body>
</html>